<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>rcatool.stats.convolve.convolve_fft &mdash; RCAT 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="rcatool.stats.pdf.freq_int_dist" href="rcatool.stats.pdf.freq_int_dist.html" />
    <link rel="prev" title="rcatool.stats.convolve.fft_prep" href="rcatool.stats.convolve.fft_prep.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            RCAT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API-reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../user_api.html">User API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../plots.html">Visualization</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../stats.html">Statistics</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../stats.html#arithmetic-routines">Arithmetic routines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats.html#asop">ASoP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats.html#bootstrapping">Bootstrapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats.html#climate-indices">Climate indices</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../stats.html#convolution">Convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats.html#probability-distributions">Probability distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats.html#sal-module">SAL module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../utils.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../internal_api.html">Internal API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">RCAT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API-reference</a></li>
          <li class="breadcrumb-item"><a href="../user_api.html">User API</a></li>
          <li class="breadcrumb-item"><a href="../stats.html">Statistics</a></li>
      <li class="breadcrumb-item active">rcatool.stats.convolve.convolve_fft</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/rcatool.stats.convolve.convolve_fft.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="rcatool-stats-convolve-convolve-fft">
<h1>rcatool.stats.convolve.convolve_fft<a class="headerlink" href="#rcatool-stats-convolve-convolve-fft" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="rcatool.stats.convolve.convolve_fft">
<span class="sig-prename descclassname"><span class="pre">rcatool.stats.convolve.</span></span><span class="sig-name descname"><span class="pre">convolve_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary='fill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fft=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_pad=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_pad=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_nan=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_edge_zeros=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_wt=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_kernel=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_huge=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fftn=&lt;function</span> <span class="pre">fftn&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifftn=&lt;function</span> <span class="pre">ifftn&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rcatool/stats/convolve.html#convolve_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rcatool.stats.convolve.convolve_fft" title="Link to this definition"></a></dt>
<dd><p>Convolve an ndarray with an nd-kernel.  Returns a convolved image with
shape = array.shape.  Assumes kernel is centered.</p>
<p><cite>convolve_fft</cite> differs from <cite>scipy.signal.fftconvolve</cite> in a few ways:</p>
<ul class="simple">
<li><p>It can treat <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values as zeros or interpolate over them.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inf</span></code> values are treated as <code class="docutils literal notranslate"><span class="pre">NaN</span></code></p></li>
<li><p>(optionally) It pads to the nearest 2^n size to improve FFT speed.</p></li>
<li><p>Its only valid <code class="docutils literal notranslate"><span class="pre">mode</span></code> is ‘same’ (i.e. the same shape array is returned)</p></li>
<li><p>It lets you use your own fft, e.g.,
<cite>pyFFTW &lt;http://pypi.python.org/pypi/pyFFTW&gt;</cite> or
<cite>pyFFTW3 &lt;http://pypi.python.org/pypi/PyFFTW3/0.2.1&gt;</cite>,
which can lead to performance improvements, depending on your system
configuration. pyFFTW3 is threaded, and therefore may yield significant
performance benefits on multi-core machines at the cost of greater
memory requirements. Specify the <code class="docutils literal notranslate"><span class="pre">fftn</span></code> and <code class="docutils literal notranslate"><span class="pre">ifftn</span></code> keywords to
override the default, which is <cite>numpy.fft.fft</cite> and <cite>numpy.fft.ifft</cite>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<cite>numpy.ndarray</cite>) – Array to be convolved with <code class="docutils literal notranslate"><span class="pre">kernel</span></code></p></li>
<li><p><strong>kernel</strong> (<cite>numpy.ndarray</cite>) – Will be normalized if <code class="docutils literal notranslate"><span class="pre">normalize_kernel</span></code> is set.  Assumed to be
centered (i.e., shifts may result if your kernel is asymmetric)</p></li>
<li><p><strong>boundary</strong> (<em>{'fill'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – A flag indicating how to handle boundaries:
* ‘fill’: set values outside the array boundary to fill_value (default)
* ‘wrap’: periodic boundary</p></li>
<li><p><strong>interpolate_nan</strong> (<em>bool</em><em>, </em><em>optional</em>) – The convolution will be re-weighted assuming <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values are meant
to be ignored, not treated as zero.  If this is off, all <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values
will be treated as zero.</p></li>
<li><p><strong>ignore_edge_zeros</strong> (<em>bool</em><em>, </em><em>optional</em>) – Ignore the zero-pad-created zeros.
This will effectively decrease the kernel area on the edges but will
not re-normalize the kernel. This parameter may result in
‘edge-brightening’ effects if you’re using a normalized kernel</p></li>
<li><p><strong>min_wt</strong> (<em>float</em><em>, </em><em>optional</em>) – If ignoring <code class="docutils literal notranslate"><span class="pre">NaN</span></code> / zeros, force all grid points with a weight less
than this value to <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (the weight of a grid point with <em>no</em>
ignored neighbors is 1.0). If <code class="docutils literal notranslate"><span class="pre">min_wt</span></code> is zero, then all zero-weight
points will be set to zero instead of <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (which they would be
otherwise, because 1/0 = nan). See the examples below</p></li>
<li><p><strong>normalize_kernel</strong> (<em>function</em><em> or </em><em>boolean</em><em>, </em><em>optional</em>) – If specified, this is the function to divide kernel by to normalize it.
e.g., <code class="docutils literal notranslate"><span class="pre">normalize_kernel=np.sum</span></code> means that kernel will be modified
to be:
<code class="docutils literal notranslate"><span class="pre">kernel</span> <span class="pre">=</span> <span class="pre">kernel</span> <span class="pre">/</span> <span class="pre">np.sum(kernel)</span></code>.  If True, defaults to
<code class="docutils literal notranslate"><span class="pre">normalize_kernel</span> <span class="pre">=</span> <span class="pre">np.sum</span></code>.</p></li>
<li><p><strong>fft_pad</strong> (<em>bool</em><em>, </em><em>optional</em>) – Default on.  Zero-pad image to the nearest 2^n</p></li>
<li><p><strong>psf_pad</strong> (<em>bool</em><em>, </em><em>optional</em>) – Default off.  Zero-pad image to be at least the sum of the image sizes
(in order to avoid edge-wrapping when smoothing)</p></li>
<li><p><strong>crop</strong> (<em>bool</em><em>, </em><em>optional</em>) – Default on.  Return an image of the size of the largest input image.
If the images are asymmetric in opposite directions, will return the
largest image in both directions.
For example, if an input image has shape [100,3] but a kernel with
shape [6,6] is used, the output will be [100,6].</p></li>
<li><p><strong>return_fft</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return the fft(image)*fft(kernel) instead of the convolution (which is
ifft(fft(image)*fft(kernel))).  Useful for making PSDs.</p></li>
<li><p><strong>fftn</strong> (<em>functions</em><em>, </em><em>optional</em>) – The fft and inverse fft functions.  Can be overridden to use your own
ffts, e.g. an fftw3 wrapper or scipy’s fftn, e.g.
<code class="docutils literal notranslate"><span class="pre">fftn=scipy.fftpack.fftn</span></code></p></li>
<li><p><strong>ifftn</strong> (<em>functions</em><em>, </em><em>optional</em>) – The fft and inverse fft functions.  Can be overridden to use your own
ffts, e.g. an fftw3 wrapper or scipy’s fftn, e.g.
<code class="docutils literal notranslate"><span class="pre">fftn=scipy.fftpack.fftn</span></code></p></li>
<li><p><strong>complex_dtype</strong> (<em>np.complex</em><em>, </em><em>optional</em>) – Which complex dtype to use.  <cite>numpy</cite> has a range of options, from 64 to
256.</p></li>
<li><p><strong>quiet</strong> (<em>bool</em><em>, </em><em>optional</em>) – Silence warning message about NaN interpolation</p></li>
<li><p><strong>allow_huge</strong> (<em>bool</em><em>, </em><em>optional</em>) – Allow huge arrays in the FFT?  If False, will raise an exception if the
array or kernel size is &gt;1 GB</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError:</strong> – If the array is bigger than 1 GB after padding, will raise this
    exception unless allow_huge is True</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">convolve</span></code></dt><dd><p>Convolve is a non-fft version of this code.  It is more memory efficient and for small kernels can be faster.</p>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>default</strong> – <strong>array</strong> convolved with <code class="docutils literal notranslate"><span class="pre">kernel</span></code>.
If <code class="docutils literal notranslate"><span class="pre">return_fft</span></code> is set, returns fft(<strong>array</strong>) * fft(<code class="docutils literal notranslate"><span class="pre">kernel</span></code>).
If crop is not set, returns the image, but with the fft-padded size
instead of the input size</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rcatool.stats.convolve.fft_prep.html" class="btn btn-neutral float-left" title="rcatool.stats.convolve.fft_prep" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rcatool.stats.pdf.freq_int_dist.html" class="btn btn-neutral float-right" title="rcatool.stats.pdf.freq_int_dist" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Petter Lind.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>